[2026-01-27 03:25:14,801][base_trainer_accelerate.py][INFO] - ***** Running training *****
[2026-01-27 03:25:14,802][base_trainer_accelerate.py][INFO] - LR = 0.00005000
[2026-01-27 03:25:14,802][base_trainer_accelerate.py][INFO] - Weigth Decay = 0.05000000
[2026-01-27 03:25:14,802][base_trainer_accelerate.py][INFO] - Instantaneous batch size per device = 1
[2026-01-27 03:25:14,803][base_trainer_accelerate.py][INFO] - Total Batch size = 8
[2026-01-27 03:25:14,803][base_trainer_accelerate.py][INFO] - Gradient Accumulation steps = 1
[2026-01-27 03:25:14,803][base_trainer_accelerate.py][INFO] - Number of epochs = 80
[2026-01-27 03:25:14,803][base_trainer_accelerate.py][INFO] - Number of training steps per epoch = 800
[2026-01-27 03:25:14,804][base_trainer_accelerate.py][INFO] - Number of total training steps = 64000
[2026-01-27 03:25:14,804][base_trainer_accelerate.py][INFO] - Number of model parameters = 892.37M
[2026-01-27 03:25:14,804][base_trainer_accelerate.py][INFO] - Number of model trainable parameters = 588.00M
[2026-01-27 03:25:14,809][base_trainer_accelerate.py][INFO] - Resuming from checkpoint /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/checkpoint_29
[2026-01-27 03:25:14,810][accelerate.accelerator][INFO] - Loading states from /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/checkpoint_29
[2026-01-27 03:25:17,357][accelerate.checkpointing][INFO] - All model weights loaded successfully
[2026-01-27 03:25:20,625][accelerate.checkpointing][INFO] - All optimizer states loaded successfully
[2026-01-27 03:25:20,626][accelerate.checkpointing][INFO] - All scheduler states loaded successfully
[2026-01-27 03:25:20,627][accelerate.checkpointing][INFO] - All dataloader sampler states loaded successfully
[2026-01-27 03:25:20,630][accelerate.checkpointing][INFO] - All random states loaded successfully
[2026-01-27 03:25:20,633][accelerate.accelerator][INFO] - Loading in 0 custom states
[2026-01-27 03:25:22,533][base_trainer_accelerate.py][INFO] - Start training epoch 29, 800 iters per inner epoch. Training dtype bf16
[2026-01-27 03:25:40,754][utils.dist][INFO] - [rank: 0] Epoch: [29]  [     0/625000]  eta: 131 days, 19:04:42  lr: 0.000035  min_lr: 0.000003  loss: 0.0154 (0.0154)  local_pts_loss: 0.0125 (0.0125)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0001)  rot_loss: 0.0151 (0.0151)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.2879 (0.2879)  time: 18.2193  data: 13.5444  max mem: 21150
[2026-01-27 03:26:42,789][utils.dist][INFO] - [rank: 0] Epoch: [29]  [    40/625000]  eta: 14 days, 3:47:09  lr: 0.000035  min_lr: 0.000003  loss: 0.0467 (0.0509)  local_pts_loss: 0.0226 (0.0241)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0017 (0.0022)  rot_loss: 0.0384 (0.0462)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.5852 (0.6612)  time: 1.5189  data: 0.0004  max mem: 25277
[2026-01-27 03:27:43,752][utils.dist][INFO] - [rank: 0] Epoch: [29]  [    80/625000]  eta: 12 days, 14:37:09  lr: 0.000034  min_lr: 0.000003  loss: 0.0412 (0.0516)  local_pts_loss: 0.0217 (0.0238)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0013 (0.0023)  rot_loss: 0.0339 (0.0438)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.5189 (0.6481)  time: 1.5255  data: 0.0004  max mem: 25277
[2026-01-27 03:28:44,319][utils.dist][INFO] - [rank: 0] Epoch: [29]  [   120/625000]  eta: 12 days, 1:26:43  lr: 0.000034  min_lr: 0.000003  loss: 0.0379 (0.0482)  local_pts_loss: 0.0190 (0.0223)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0016 (0.0022)  rot_loss: 0.0279 (0.0409)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.5875 (0.6411)  time: 1.5038  data: 0.0004  max mem: 25277
[2026-01-27 03:29:45,089][utils.dist][INFO] - [rank: 0] Epoch: [29]  [   160/625000]  eta: 11 days, 19:01:41  lr: 0.000034  min_lr: 0.000003  loss: 0.0279 (0.0451)  local_pts_loss: 0.0189 (0.0216)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0006 (0.0020)  rot_loss: 0.0198 (0.0385)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4622 (0.6278)  time: 1.5320  data: 0.0004  max mem: 25280
[2026-01-27 03:30:46,185][utils.dist][INFO] - [rank: 0] Epoch: [29]  [   200/625000]  eta: 11 days, 15:26:22  lr: 0.000034  min_lr: 0.000003  loss: 0.0328 (0.0427)  local_pts_loss: 0.0165 (0.0207)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0011 (0.0018)  rot_loss: 0.0366 (0.0371)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.7174 (0.6326)  time: 1.4920  data: 0.0004  max mem: 25280
[2026-01-27 03:31:47,153][utils.dist][INFO] - [rank: 0] Epoch: [29]  [   240/625000]  eta: 11 days, 12:56:40  lr: 0.000034  min_lr: 0.000003  loss: 0.0279 (0.0411)  local_pts_loss: 0.0161 (0.0201)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0007 (0.0017)  rot_loss: 0.0270 (0.0356)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.5873 (0.6318)  time: 1.5313  data: 0.0004  max mem: 25280
[2026-01-27 03:32:47,921][utils.dist][INFO] - [rank: 0] Epoch: [29]  [   280/625000]  eta: 11 days, 11:01:51  lr: 0.000034  min_lr: 0.000003  loss: 0.0208 (0.0386)  local_pts_loss: 0.0144 (0.0194)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0005 (0.0016)  rot_loss: 0.0184 (0.0335)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4175 (0.6128)  time: 1.5323  data: 0.0004  max mem: 25280
[2026-01-27 03:33:17,235][base_trainer_accelerate.py][INFO] - Error in depth visualization: axes don't match array
[2026-01-27 03:33:17,236][base_trainer_accelerate.py][INFO] - Traceback (most recent call last):
  File "/mnt/localssd/Pi3_training/./trainers/pi3_trainer.py", line 176, in log_depth_visualizations
    fig = self.create_depth_visualization(rgb, depth_gt, depth_p)
  File "/mnt/localssd/Pi3_training/./trainers/pi3_trainer.py", line 115, in create_depth_visualization
    rgb = rgb.transpose(1, 2, 0)
ValueError: axes don't match array

[2026-01-27 03:33:48,874][utils.dist][INFO] - [rank: 0] Epoch: [29]  [   320/625000]  eta: 11 days, 9:41:25  lr: 0.000034  min_lr: 0.000003  loss: 0.0230 (0.0369)  local_pts_loss: 0.0161 (0.0190)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0004 (0.0015)  rot_loss: 0.0213 (0.0322)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4398 (0.6008)  time: 1.5109  data: 0.0003  max mem: 25280
[2026-01-27 03:34:49,951][utils.dist][INFO] - [rank: 0] Epoch: [29]  [   360/625000]  eta: 11 days, 8:42:10  lr: 0.000034  min_lr: 0.000003  loss: 0.0235 (0.0354)  local_pts_loss: 0.0165 (0.0187)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0004 (0.0014)  rot_loss: 0.0194 (0.0310)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4799 (0.5879)  time: 1.5413  data: 0.0004  max mem: 25280
[2026-01-27 03:35:51,183][utils.dist][INFO] - [rank: 0] Epoch: [29]  [   400/625000]  eta: 11 days, 7:58:34  lr: 0.000034  min_lr: 0.000003  loss: 0.0232 (0.0342)  local_pts_loss: 0.0148 (0.0183)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0006 (0.0013)  rot_loss: 0.0203 (0.0299)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.6082 (0.5838)  time: 1.5324  data: 0.0004  max mem: 25280
[2026-01-27 03:36:52,256][utils.dist][INFO] - [rank: 0] Epoch: [29]  [   440/625000]  eta: 11 days, 7:18:57  lr: 0.000034  min_lr: 0.000003  loss: 0.0235 (0.0334)  local_pts_loss: 0.0161 (0.0182)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0007 (0.0012)  rot_loss: 0.0173 (0.0289)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.5408 (0.5854)  time: 1.5443  data: 0.0004  max mem: 25280
[2026-01-27 03:37:53,750][utils.dist][INFO] - [rank: 0] Epoch: [29]  [   480/625000]  eta: 11 days, 6:54:49  lr: 0.000034  min_lr: 0.000003  loss: 0.0208 (0.0324)  local_pts_loss: 0.0150 (0.0180)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0004 (0.0012)  rot_loss: 0.0158 (0.0280)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4391 (0.5802)  time: 1.5708  data: 0.0004  max mem: 25280
[2026-01-27 03:38:55,567][utils.dist][INFO] - [rank: 0] Epoch: [29]  [   520/625000]  eta: 11 days, 6:40:44  lr: 0.000034  min_lr: 0.000003  loss: 0.0186 (0.0315)  local_pts_loss: 0.0145 (0.0177)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0002 (0.0011)  rot_loss: 0.0133 (0.0271)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3649 (0.5728)  time: 1.5488  data: 0.0004  max mem: 25280
[2026-01-27 03:39:56,306][utils.dist][INFO] - [rank: 0] Epoch: [29]  [   560/625000]  eta: 11 days, 6:08:29  lr: 0.000034  min_lr: 0.000003  loss: 0.0181 (0.0307)  local_pts_loss: 0.0137 (0.0175)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0003 (0.0011)  rot_loss: 0.0133 (0.0263)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3371 (0.5660)  time: 1.5452  data: 0.0004  max mem: 25280
[2026-01-27 03:40:57,389][utils.dist][INFO] - [rank: 0] Epoch: [29]  [   600/625000]  eta: 11 days, 5:46:22  lr: 0.000034  min_lr: 0.000003  loss: 0.0207 (0.0302)  local_pts_loss: 0.0153 (0.0174)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0004 (0.0010)  rot_loss: 0.0193 (0.0260)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4254 (0.5607)  time: 1.5050  data: 0.0003  max mem: 25280
[2026-01-27 03:41:58,520][utils.dist][INFO] - [rank: 0] Epoch: [29]  [   640/625000]  eta: 11 days, 5:27:38  lr: 0.000034  min_lr: 0.000003  loss: 0.0192 (0.0295)  local_pts_loss: 0.0135 (0.0171)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0003 (0.0010)  rot_loss: 0.0202 (0.0255)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4309 (0.5554)  time: 1.5015  data: 0.0004  max mem: 25280
[2026-01-27 03:42:59,377][utils.dist][INFO] - [rank: 0] Epoch: [29]  [   680/625000]  eta: 11 days, 5:06:49  lr: 0.000034  min_lr: 0.000003  loss: 0.0166 (0.0288)  local_pts_loss: 0.0122 (0.0168)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0003 (0.0010)  rot_loss: 0.0135 (0.0251)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3246 (0.5525)  time: 1.5112  data: 0.0004  max mem: 25280
[2026-01-27 03:44:01,267][utils.dist][INFO] - [rank: 0] Epoch: [29]  [   720/625000]  eta: 11 days, 5:03:07  lr: 0.000034  min_lr: 0.000003  loss: 0.0186 (0.0284)  local_pts_loss: 0.0141 (0.0167)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0002 (0.0009)  rot_loss: 0.0143 (0.0246)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4246 (0.5503)  time: 1.5407  data: 0.0004  max mem: 25280
[2026-01-27 03:45:01,904][utils.dist][INFO] - [rank: 0] Epoch: [29]  [   760/625000]  eta: 11 days, 4:42:33  lr: 0.000034  min_lr: 0.000003  loss: 0.0170 (0.0279)  local_pts_loss: 0.0127 (0.0166)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0003 (0.0009)  rot_loss: 0.0132 (0.0241)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3839 (0.5464)  time: 1.5009  data: 0.0004  max mem: 25280
[2026-01-27 03:46:02,391][base_trainer_accelerate.py][INFO] - Error in depth visualization: axes don't match array
[2026-01-27 03:46:02,392][base_trainer_accelerate.py][INFO] - Traceback (most recent call last):
  File "/mnt/localssd/Pi3_training/./trainers/pi3_trainer.py", line 176, in log_depth_visualizations
    fig = self.create_depth_visualization(rgb, depth_gt, depth_p)
  File "/mnt/localssd/Pi3_training/./trainers/pi3_trainer.py", line 115, in create_depth_visualization
    rgb = rgb.transpose(1, 2, 0)
ValueError: axes don't match array

[2026-01-27 03:46:02,408][base_trainer_accelerate.py][INFO] - Start validation for epoch 29
[2026-01-27 03:46:05,758][base_trainer_accelerate.py][INFO] - Error in depth visualization: Invalid shape (8, 3, 224, 224) for image data
[2026-01-27 03:46:05,765][base_trainer_accelerate.py][INFO] - Traceback (most recent call last):
  File "/mnt/localssd/Pi3_training/./trainers/pi3_trainer.py", line 176, in log_depth_visualizations
    fig = self.create_depth_visualization(rgb, depth_gt, depth_p)
  File "/mnt/localssd/Pi3_training/./trainers/pi3_trainer.py", line 118, in create_depth_visualization
    axes[0].imshow(rgb)
  File "/mnt/localssd/miniconda3/envs/py39/lib/python3.9/site-packages/matplotlib/__init__.py", line 1476, in inner
    return func(
  File "/mnt/localssd/miniconda3/envs/py39/lib/python3.9/site-packages/matplotlib/axes/_axes.py", line 5895, in imshow
    im.set_data(X)
  File "/mnt/localssd/miniconda3/envs/py39/lib/python3.9/site-packages/matplotlib/image.py", line 729, in set_data
    self._A = self._normalize_image_array(A)
  File "/mnt/localssd/miniconda3/envs/py39/lib/python3.9/site-packages/matplotlib/image.py", line 697, in _normalize_image_array
    raise TypeError(f"Invalid shape {A.shape} for image data")
TypeError: Invalid shape (8, 3, 224, 224) for image data

[2026-01-27 03:46:05,767][utils.dist][INFO] - [rank: 0] Validation Epoch: [29]  [ 0/15]  eta: 0:00:50  loss: 0.0222 (0.0222)  local_pts_loss: 0.0188 (0.0188)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0002 (0.0002)  rot_loss: 0.0130 (0.0130)  time: 3.3574  data: 2.6529  max mem: 25280
[2026-01-27 03:46:11,567][utils.dist][INFO] - [rank: 0] Validation Epoch: [29]  [14/15]  eta: 0:00:00  loss: 0.0222 (0.0222)  local_pts_loss: 0.0188 (0.0188)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0002 (0.0002)  rot_loss: 0.0130 (0.0130)  time: 0.6104  data: 0.1771  max mem: 25280
[2026-01-27 03:46:11,842][utils.dist][INFO] - [rank: 0] Validation Epoch: [29] Total time: 0:00:09 (0.6289 s / it)
[2026-01-27 03:46:15,130][base_trainer_accelerate.py][INFO] - Validation results: loss: 0.0222 (0.0223)  local_pts_loss: 0.0188 (0.0188)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0002 (0.0002)  rot_loss: 0.0130 (0.0130)
[2026-01-27 03:46:15,134][accelerate.accelerator][INFO] - Saving current state to /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/best_model
[2026-01-27 03:46:19,806][accelerate.checkpointing][INFO] - Model weights saved in /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/best_model/pytorch_model.bin
[2026-01-27 03:46:25,491][accelerate.checkpointing][INFO] - Optimizer state saved in /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/best_model/optimizer.bin
[2026-01-27 03:46:25,493][accelerate.checkpointing][INFO] - Scheduler state saved in /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/best_model/scheduler.bin
[2026-01-27 03:46:25,495][accelerate.checkpointing][INFO] - Random states saved in /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/best_model/random_states_0.pkl
[2026-01-27 03:46:25,497][base_trainer_accelerate.py][INFO] - Saved best model at epoch 29 with val_metric: 0.0223
[2026-01-27 03:46:25,499][accelerate.accelerator][INFO] - Saving current state to /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/checkpoint_29
[2026-01-27 03:46:29,848][accelerate.checkpointing][INFO] - Model weights saved in /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/checkpoint_29/pytorch_model.bin
[2026-01-27 03:46:35,449][accelerate.checkpointing][INFO] - Optimizer state saved in /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/checkpoint_29/optimizer.bin
[2026-01-27 03:46:35,450][accelerate.checkpointing][INFO] - Scheduler state saved in /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/checkpoint_29/scheduler.bin
[2026-01-27 03:46:35,452][accelerate.checkpointing][INFO] - Random states saved in /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/checkpoint_29/random_states_0.pkl
[2026-01-27 03:46:35,453][base_trainer_accelerate.py][INFO] - Saved state for global step 24000
[2026-01-27 03:46:37,538][base_trainer_accelerate.py][INFO] - Start training epoch 30, 800 iters per inner epoch. Training dtype bf16
[2026-01-27 03:46:52,940][utils.dist][INFO] - [rank: 0] Epoch: [30]  [     0/625000]  eta: 111 days, 9:45:37  lr: 0.000034  min_lr: 0.000003  loss: 0.0513 (0.0513)  local_pts_loss: 0.0196 (0.0196)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0029 (0.0029)  rot_loss: 0.0264 (0.0264)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.8999 (0.8999)  time: 15.4009  data: 9.4120  max mem: 24133
[2026-01-27 03:47:53,066][utils.dist][INFO] - [rank: 0] Epoch: [30]  [    40/625000]  eta: 13 days, 7:46:15  lr: 0.000034  min_lr: 0.000003  loss: 0.0209 (0.0236)  local_pts_loss: 0.0141 (0.0150)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0005 (0.0007)  rot_loss: 0.0159 (0.0183)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4981 (0.5585)  time: 1.5023  data: 0.0004  max mem: 25273
[2026-01-27 03:48:54,719][utils.dist][INFO] - [rank: 0] Epoch: [30]  [    80/625000]  eta: 12 days, 5:57:51  lr: 0.000034  min_lr: 0.000003  loss: 0.0163 (0.0218)  local_pts_loss: 0.0130 (0.0145)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0002 (0.0006)  rot_loss: 0.0121 (0.0163)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3939 (0.5315)  time: 1.5327  data: 0.0004  max mem: 25273
[2026-01-27 03:49:54,297][utils.dist][INFO] - [rank: 0] Epoch: [30]  [   120/625000]  eta: 11 days, 18:13:59  lr: 0.000034  min_lr: 0.000003  loss: 0.0180 (0.0205)  local_pts_loss: 0.0126 (0.0139)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0003 (0.0005)  rot_loss: 0.0153 (0.0163)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4208 (0.5097)  time: 1.5014  data: 0.0004  max mem: 25277
[2026-01-27 03:50:54,520][utils.dist][INFO] - [rank: 0] Epoch: [30]  [   160/625000]  eta: 11 days, 13:00:59  lr: 0.000033  min_lr: 0.000003  loss: 0.0161 (0.0198)  local_pts_loss: 0.0127 (0.0137)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0002 (0.0004)  rot_loss: 0.0140 (0.0163)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4160 (0.5092)  time: 1.5077  data: 0.0004  max mem: 25282
[2026-01-27 03:51:54,747][utils.dist][INFO] - [rank: 0] Epoch: [30]  [   200/625000]  eta: 11 days, 9:52:28  lr: 0.000033  min_lr: 0.000003  loss: 0.0176 (0.0198)  local_pts_loss: 0.0130 (0.0138)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0003 (0.0004)  rot_loss: 0.0122 (0.0164)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4740 (0.5109)  time: 1.5394  data: 0.0004  max mem: 25282
[2026-01-27 03:52:54,766][utils.dist][INFO] - [rank: 0] Epoch: [30]  [   240/625000]  eta: 11 days, 7:37:11  lr: 0.000033  min_lr: 0.000003  loss: 0.0170 (0.0194)  local_pts_loss: 0.0128 (0.0137)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0002 (0.0004)  rot_loss: 0.0127 (0.0160)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4128 (0.5047)  time: 1.4951  data: 0.0004  max mem: 25282
[2026-01-27 03:53:55,279][utils.dist][INFO] - [rank: 0] Epoch: [30]  [   280/625000]  eta: 11 days, 6:18:25  lr: 0.000033  min_lr: 0.000003  loss: 0.0174 (0.0191)  local_pts_loss: 0.0128 (0.0136)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0003 (0.0004)  rot_loss: 0.0134 (0.0156)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4510 (0.5024)  time: 1.5067  data: 0.0004  max mem: 25282
[2026-01-27 03:54:56,663][utils.dist][INFO] - [rank: 0] Epoch: [30]  [   320/625000]  eta: 11 days, 5:47:17  lr: 0.000033  min_lr: 0.000003  loss: 0.0172 (0.0191)  local_pts_loss: 0.0130 (0.0136)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0003 (0.0004)  rot_loss: 0.0131 (0.0155)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4118 (0.5009)  time: 1.5438  data: 0.0004  max mem: 25282
[2026-01-27 03:55:58,530][utils.dist][INFO] - [rank: 0] Epoch: [30]  [   360/625000]  eta: 11 days, 5:36:45  lr: 0.000033  min_lr: 0.000003  loss: 0.0164 (0.0189)  local_pts_loss: 0.0123 (0.0135)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0003 (0.0004)  rot_loss: 0.0123 (0.0152)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4269 (0.4966)  time: 1.5681  data: 0.0004  max mem: 25282
[2026-01-27 03:56:59,389][utils.dist][INFO] - [rank: 0] Epoch: [30]  [   400/625000]  eta: 11 days, 5:01:57  lr: 0.000033  min_lr: 0.000003  loss: 0.0168 (0.0187)  local_pts_loss: 0.0132 (0.0134)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0002 (0.0004)  rot_loss: 0.0123 (0.0149)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4456 (0.4900)  time: 1.5447  data: 0.0004  max mem: 25282
[2026-01-27 03:58:00,967][utils.dist][INFO] - [rank: 0] Epoch: [30]  [   440/625000]  eta: 11 days, 4:50:14  lr: 0.000033  min_lr: 0.000003  loss: 0.0152 (0.0185)  local_pts_loss: 0.0116 (0.0133)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0004)  rot_loss: 0.0132 (0.0150)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3454 (0.4803)  time: 1.5185  data: 0.0004  max mem: 25282
[2026-01-27 03:59:02,256][utils.dist][INFO] - [rank: 0] Epoch: [30]  [   480/625000]  eta: 11 days, 4:34:05  lr: 0.000033  min_lr: 0.000003  loss: 0.0179 (0.0185)  local_pts_loss: 0.0126 (0.0133)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0003 (0.0004)  rot_loss: 0.0112 (0.0149)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4110 (0.4796)  time: 1.5415  data: 0.0004  max mem: 25282
[2026-01-27 03:59:31,928][base_trainer_accelerate.py][INFO] - Error in depth visualization: axes don't match array
[2026-01-27 03:59:31,928][base_trainer_accelerate.py][INFO] - Traceback (most recent call last):
  File "/mnt/localssd/Pi3_training/./trainers/pi3_trainer.py", line 176, in log_depth_visualizations
    fig = self.create_depth_visualization(rgb, depth_gt, depth_p)
  File "/mnt/localssd/Pi3_training/./trainers/pi3_trainer.py", line 115, in create_depth_visualization
    rgb = rgb.transpose(1, 2, 0)
ValueError: axes don't match array

[2026-01-27 04:00:03,505][utils.dist][INFO] - [rank: 0] Epoch: [30]  [   520/625000]  eta: 11 days, 4:19:25  lr: 0.000033  min_lr: 0.000003  loss: 0.0147 (0.0183)  local_pts_loss: 0.0118 (0.0132)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0002 (0.0004)  rot_loss: 0.0123 (0.0148)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4112 (0.4763)  time: 1.5019  data: 0.0004  max mem: 25282
[2026-01-27 04:01:03,984][utils.dist][INFO] - [rank: 0] Epoch: [30]  [   560/625000]  eta: 11 days, 3:52:26  lr: 0.000033  min_lr: 0.000003  loss: 0.0174 (0.0182)  local_pts_loss: 0.0122 (0.0131)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0003 (0.0004)  rot_loss: 0.0123 (0.0147)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4845 (0.4783)  time: 1.5064  data: 0.0004  max mem: 25282
[2026-01-27 04:02:07,008][utils.dist][INFO] - [rank: 0] Epoch: [30]  [   600/625000]  eta: 11 days, 4:12:59  lr: 0.000033  min_lr: 0.000003  loss: 0.0153 (0.0181)  local_pts_loss: 0.0123 (0.0131)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0002 (0.0004)  rot_loss: 0.0122 (0.0145)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4125 (0.4740)  time: 1.5728  data: 0.0004  max mem: 25282
[2026-01-27 04:03:08,041][utils.dist][INFO] - [rank: 0] Epoch: [30]  [   640/625000]  eta: 11 days, 3:58:30  lr: 0.000033  min_lr: 0.000003  loss: 0.0144 (0.0179)  local_pts_loss: 0.0124 (0.0130)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0003)  rot_loss: 0.0105 (0.0144)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3065 (0.4698)  time: 1.5626  data: 0.0004  max mem: 25282
[2026-01-27 04:04:10,182][utils.dist][INFO] - [rank: 0] Epoch: [30]  [   680/625000]  eta: 11 days, 4:02:32  lr: 0.000033  min_lr: 0.000003  loss: 0.0134 (0.0177)  local_pts_loss: 0.0108 (0.0129)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0002 (0.0003)  rot_loss: 0.0108 (0.0143)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.2951 (0.4657)  time: 1.5406  data: 0.0004  max mem: 25282
[2026-01-27 04:05:12,275][utils.dist][INFO] - [rank: 0] Epoch: [30]  [   720/625000]  eta: 11 days, 4:05:19  lr: 0.000033  min_lr: 0.000003  loss: 0.0146 (0.0176)  local_pts_loss: 0.0110 (0.0128)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0003 (0.0003)  rot_loss: 0.0129 (0.0144)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3990 (0.4635)  time: 1.5367  data: 0.0004  max mem: 25282
[2026-01-27 04:06:13,515][utils.dist][INFO] - [rank: 0] Epoch: [30]  [   760/625000]  eta: 11 days, 3:56:02  lr: 0.000033  min_lr: 0.000003  loss: 0.0135 (0.0175)  local_pts_loss: 0.0111 (0.0127)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0003)  rot_loss: 0.0110 (0.0144)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.2709 (0.4599)  time: 1.5410  data: 0.0003  max mem: 25282
[2026-01-27 04:07:13,905][base_trainer_accelerate.py][INFO] - Start validation for epoch 30
[2026-01-27 04:07:18,438][base_trainer_accelerate.py][INFO] - Error in depth visualization: Invalid shape (8, 3, 224, 224) for image data
[2026-01-27 04:07:18,439][base_trainer_accelerate.py][INFO] - Traceback (most recent call last):
  File "/mnt/localssd/Pi3_training/./trainers/pi3_trainer.py", line 176, in log_depth_visualizations
    fig = self.create_depth_visualization(rgb, depth_gt, depth_p)
  File "/mnt/localssd/Pi3_training/./trainers/pi3_trainer.py", line 118, in create_depth_visualization
    axes[0].imshow(rgb)
  File "/mnt/localssd/miniconda3/envs/py39/lib/python3.9/site-packages/matplotlib/__init__.py", line 1476, in inner
    return func(
  File "/mnt/localssd/miniconda3/envs/py39/lib/python3.9/site-packages/matplotlib/axes/_axes.py", line 5895, in imshow
    im.set_data(X)
  File "/mnt/localssd/miniconda3/envs/py39/lib/python3.9/site-packages/matplotlib/image.py", line 729, in set_data
    self._A = self._normalize_image_array(A)
  File "/mnt/localssd/miniconda3/envs/py39/lib/python3.9/site-packages/matplotlib/image.py", line 697, in _normalize_image_array
    raise TypeError(f"Invalid shape {A.shape} for image data")
TypeError: Invalid shape (8, 3, 224, 224) for image data

[2026-01-27 04:07:18,441][utils.dist][INFO] - [rank: 0] Validation Epoch: [30]  [ 0/15]  eta: 0:01:08  loss: 0.0193 (0.0193)  local_pts_loss: 0.0145 (0.0145)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0003 (0.0003)  rot_loss: 0.0146 (0.0146)  time: 4.5338  data: 4.0676  max mem: 25282
[2026-01-27 04:07:24,370][utils.dist][INFO] - [rank: 0] Validation Epoch: [30]  [14/15]  eta: 0:00:00  loss: 0.0193 (0.0193)  local_pts_loss: 0.0145 (0.0145)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0003 (0.0003)  rot_loss: 0.0146 (0.0146)  time: 0.6975  data: 0.2882  max mem: 25282
[2026-01-27 04:07:24,642][utils.dist][INFO] - [rank: 0] Validation Epoch: [30] Total time: 0:00:10 (0.7157 s / it)
[2026-01-27 04:07:25,043][base_trainer_accelerate.py][INFO] - Validation results: loss: 0.0193 (0.0193)  local_pts_loss: 0.0145 (0.0145)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0003 (0.0003)  rot_loss: 0.0146 (0.0145)
[2026-01-27 04:07:25,045][accelerate.accelerator][INFO] - Saving current state to /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/best_model
[2026-01-27 04:07:29,455][accelerate.checkpointing][INFO] - Model weights saved in /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/best_model/pytorch_model.bin
[2026-01-27 04:07:35,328][accelerate.checkpointing][INFO] - Optimizer state saved in /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/best_model/optimizer.bin
[2026-01-27 04:07:35,329][accelerate.checkpointing][INFO] - Scheduler state saved in /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/best_model/scheduler.bin
[2026-01-27 04:07:35,331][accelerate.checkpointing][INFO] - Random states saved in /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/best_model/random_states_0.pkl
[2026-01-27 04:07:35,333][base_trainer_accelerate.py][INFO] - Saved best model at epoch 30 with val_metric: 0.0193
[2026-01-27 04:07:37,437][base_trainer_accelerate.py][INFO] - Start training epoch 31, 800 iters per inner epoch. Training dtype bf16
[2026-01-27 04:07:53,155][utils.dist][INFO] - [rank: 0] Epoch: [31]  [     0/625000]  eta: 113 days, 16:27:16  lr: 0.000033  min_lr: 0.000003  loss: 0.0130 (0.0130)  local_pts_loss: 0.0117 (0.0117)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0001)  rot_loss: 0.0076 (0.0076)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.2389 (0.2389)  time: 15.7159  data: 13.4089  max mem: 24850
[2026-01-27 04:08:53,975][utils.dist][INFO] - [rank: 0] Epoch: [31]  [    40/625000]  eta: 13 days, 12:02:52  lr: 0.000033  min_lr: 0.000003  loss: 0.0145 (0.0164)  local_pts_loss: 0.0119 (0.0128)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0002)  rot_loss: 0.0115 (0.0128)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3831 (0.4727)  time: 1.5051  data: 0.0003  max mem: 25266
[2026-01-27 04:09:54,853][utils.dist][INFO] - [rank: 0] Epoch: [31]  [    80/625000]  eta: 12 days, 6:28:07  lr: 0.000033  min_lr: 0.000003  loss: 0.0127 (0.0144)  local_pts_loss: 0.0103 (0.0116)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0002)  rot_loss: 0.0088 (0.0114)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.2696 (0.3801)  time: 1.4972  data: 0.0004  max mem: 25278
[2026-01-27 04:10:58,461][utils.dist][INFO] - [rank: 0] Epoch: [31]  [   120/625000]  eta: 12 days, 0:21:11  lr: 0.000033  min_lr: 0.000003  loss: 0.0146 (0.0144)  local_pts_loss: 0.0112 (0.0114)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0002 (0.0002)  rot_loss: 0.0157 (0.0126)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3972 (0.3840)  time: 1.5870  data: 0.0004  max mem: 25278
[2026-01-27 04:11:59,103][utils.dist][INFO] - [rank: 0] Epoch: [31]  [   160/625000]  eta: 11 days, 18:04:06  lr: 0.000033  min_lr: 0.000003  loss: 0.0198 (0.0159)  local_pts_loss: 0.0133 (0.0119)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0004 (0.0003)  rot_loss: 0.0146 (0.0138)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.5253 (0.4352)  time: 1.5515  data: 0.0003  max mem: 25278
[2026-01-27 04:12:59,822][base_trainer_accelerate.py][INFO] - Error in depth visualization: Invalid shape (32, 3, 224, 224) for image data
[2026-01-27 04:12:59,823][base_trainer_accelerate.py][INFO] - Traceback (most recent call last):
  File "/mnt/localssd/Pi3_training/./trainers/pi3_trainer.py", line 176, in log_depth_visualizations
    fig = self.create_depth_visualization(rgb, depth_gt, depth_p)
  File "/mnt/localssd/Pi3_training/./trainers/pi3_trainer.py", line 118, in create_depth_visualization
    axes[0].imshow(rgb)
  File "/mnt/localssd/miniconda3/envs/py39/lib/python3.9/site-packages/matplotlib/__init__.py", line 1476, in inner
    return func(
  File "/mnt/localssd/miniconda3/envs/py39/lib/python3.9/site-packages/matplotlib/axes/_axes.py", line 5895, in imshow
    im.set_data(X)
  File "/mnt/localssd/miniconda3/envs/py39/lib/python3.9/site-packages/matplotlib/image.py", line 729, in set_data
    self._A = self._normalize_image_array(A)
  File "/mnt/localssd/miniconda3/envs/py39/lib/python3.9/site-packages/matplotlib/image.py", line 697, in _normalize_image_array
    raise TypeError(f"Invalid shape {A.shape} for image data")
TypeError: Invalid shape (32, 3, 224, 224) for image data

[2026-01-27 04:13:01,519][utils.dist][INFO] - [rank: 0] Epoch: [31]  [   200/625000]  eta: 11 days, 15:48:39  lr: 0.000032  min_lr: 0.000003  loss: 0.0142 (0.0157)  local_pts_loss: 0.0118 (0.0118)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0002 (0.0003)  rot_loss: 0.0122 (0.0136)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3931 (0.4291)  time: 1.5605  data: 0.0004  max mem: 25278
[2026-01-27 04:14:02,449][utils.dist][INFO] - [rank: 0] Epoch: [31]  [   240/625000]  eta: 11 days, 13:13:35  lr: 0.000032  min_lr: 0.000003  loss: 0.0178 (0.0161)  local_pts_loss: 0.0126 (0.0120)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0003 (0.0003)  rot_loss: 0.0122 (0.0135)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4360 (0.4418)  time: 1.5318  data: 0.0004  max mem: 25278
[2026-01-27 04:15:04,236][utils.dist][INFO] - [rank: 0] Epoch: [31]  [   280/625000]  eta: 11 days, 11:54:09  lr: 0.000032  min_lr: 0.000003  loss: 0.0205 (0.0166)  local_pts_loss: 0.0134 (0.0122)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0006 (0.0003)  rot_loss: 0.0146 (0.0136)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.5954 (0.4631)  time: 1.5422  data: 0.0004  max mem: 25278
[2026-01-27 04:16:05,804][utils.dist][INFO] - [rank: 0] Epoch: [31]  [   320/625000]  eta: 11 days, 10:47:11  lr: 0.000032  min_lr: 0.000003  loss: 0.0135 (0.0165)  local_pts_loss: 0.0107 (0.0121)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0003)  rot_loss: 0.0111 (0.0135)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3267 (0.4514)  time: 1.5327  data: 0.0003  max mem: 25286
[2026-01-27 04:17:07,066][utils.dist][INFO] - [rank: 0] Epoch: [31]  [   360/625000]  eta: 11 days, 9:45:56  lr: 0.000032  min_lr: 0.000003  loss: 0.0146 (0.0163)  local_pts_loss: 0.0118 (0.0121)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0003)  rot_loss: 0.0143 (0.0133)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3926 (0.4432)  time: 1.5159  data: 0.0004  max mem: 25286
[2026-01-27 04:18:08,661][utils.dist][INFO] - [rank: 0] Epoch: [31]  [   400/625000]  eta: 11 days, 9:05:24  lr: 0.000032  min_lr: 0.000003  loss: 0.0149 (0.0162)  local_pts_loss: 0.0120 (0.0121)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0002 (0.0003)  rot_loss: 0.0099 (0.0132)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4096 (0.4433)  time: 1.5148  data: 0.0004  max mem: 25286
[2026-01-27 04:19:11,361][utils.dist][INFO] - [rank: 0] Epoch: [31]  [   440/625000]  eta: 11 days, 8:58:05  lr: 0.000032  min_lr: 0.000003  loss: 0.0122 (0.0159)  local_pts_loss: 0.0101 (0.0120)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0003)  rot_loss: 0.0097 (0.0129)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3187 (0.4321)  time: 1.5538  data: 0.0004  max mem: 25286
[2026-01-27 04:20:12,015][utils.dist][INFO] - [rank: 0] Epoch: [31]  [   480/625000]  eta: 11 days, 8:07:33  lr: 0.000032  min_lr: 0.000003  loss: 0.0126 (0.0157)  local_pts_loss: 0.0108 (0.0119)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0003)  rot_loss: 0.0093 (0.0128)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3237 (0.4292)  time: 1.5377  data: 0.0004  max mem: 25286
[2026-01-27 04:21:12,688][utils.dist][INFO] - [rank: 0] Epoch: [31]  [   520/625000]  eta: 11 days, 7:25:00  lr: 0.000032  min_lr: 0.000003  loss: 0.0138 (0.0156)  local_pts_loss: 0.0116 (0.0119)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0002)  rot_loss: 0.0092 (0.0127)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3504 (0.4274)  time: 1.5231  data: 0.0004  max mem: 25286
[2026-01-27 04:22:14,764][utils.dist][INFO] - [rank: 0] Epoch: [31]  [   560/625000]  eta: 11 days, 7:14:23  lr: 0.000032  min_lr: 0.000003  loss: 0.0122 (0.0154)  local_pts_loss: 0.0110 (0.0118)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0002)  rot_loss: 0.0082 (0.0124)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.2705 (0.4206)  time: 1.5748  data: 0.0004  max mem: 25286
[2026-01-27 04:23:16,295][utils.dist][INFO] - [rank: 0] Epoch: [31]  [   600/625000]  eta: 11 days, 6:55:37  lr: 0.000032  min_lr: 0.000003  loss: 0.0127 (0.0152)  local_pts_loss: 0.0104 (0.0117)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0002)  rot_loss: 0.0106 (0.0123)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3099 (0.4137)  time: 1.5206  data: 0.0004  max mem: 25286
[2026-01-27 04:24:18,475][utils.dist][INFO] - [rank: 0] Epoch: [31]  [   640/625000]  eta: 11 days, 6:49:36  lr: 0.000032  min_lr: 0.000003  loss: 0.0136 (0.0151)  local_pts_loss: 0.0103 (0.0116)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0002 (0.0002)  rot_loss: 0.0100 (0.0122)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3352 (0.4141)  time: 1.5416  data: 0.0004  max mem: 25286
[2026-01-27 04:25:21,372][utils.dist][INFO] - [rank: 0] Epoch: [31]  [   680/625000]  eta: 11 days, 6:55:08  lr: 0.000032  min_lr: 0.000003  loss: 0.0147 (0.0152)  local_pts_loss: 0.0116 (0.0116)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0002 (0.0002)  rot_loss: 0.0100 (0.0122)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4435 (0.4197)  time: 1.5741  data: 0.0004  max mem: 25286
[2026-01-27 04:25:50,654][base_trainer_accelerate.py][INFO] - Error in depth visualization: Invalid shape (4, 3, 224, 224) for image data
[2026-01-27 04:25:50,655][base_trainer_accelerate.py][INFO] - Traceback (most recent call last):
  File "/mnt/localssd/Pi3_training/./trainers/pi3_trainer.py", line 176, in log_depth_visualizations
    fig = self.create_depth_visualization(rgb, depth_gt, depth_p)
  File "/mnt/localssd/Pi3_training/./trainers/pi3_trainer.py", line 118, in create_depth_visualization
    axes[0].imshow(rgb)
  File "/mnt/localssd/miniconda3/envs/py39/lib/python3.9/site-packages/matplotlib/__init__.py", line 1476, in inner
    return func(
  File "/mnt/localssd/miniconda3/envs/py39/lib/python3.9/site-packages/matplotlib/axes/_axes.py", line 5895, in imshow
    im.set_data(X)
  File "/mnt/localssd/miniconda3/envs/py39/lib/python3.9/site-packages/matplotlib/image.py", line 729, in set_data
    self._A = self._normalize_image_array(A)
  File "/mnt/localssd/miniconda3/envs/py39/lib/python3.9/site-packages/matplotlib/image.py", line 697, in _normalize_image_array
    raise TypeError(f"Invalid shape {A.shape} for image data")
TypeError: Invalid shape (4, 3, 224, 224) for image data

[2026-01-27 04:26:23,317][utils.dist][INFO] - [rank: 0] Epoch: [31]  [   720/625000]  eta: 11 days, 6:46:11  lr: 0.000032  min_lr: 0.000003  loss: 0.0130 (0.0151)  local_pts_loss: 0.0108 (0.0116)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0002)  rot_loss: 0.0102 (0.0121)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.2965 (0.4177)  time: 1.5647  data: 0.0004  max mem: 25286
[2026-01-27 04:27:24,943][utils.dist][INFO] - [rank: 0] Epoch: [31]  [   760/625000]  eta: 11 days, 6:33:43  lr: 0.000032  min_lr: 0.000003  loss: 0.0142 (0.0151)  local_pts_loss: 0.0112 (0.0116)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0002 (0.0002)  rot_loss: 0.0114 (0.0121)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3973 (0.4166)  time: 1.5359  data: 0.0004  max mem: 25286
[2026-01-27 04:28:24,804][base_trainer_accelerate.py][INFO] - Start validation for epoch 31
[2026-01-27 04:28:30,056][base_trainer_accelerate.py][INFO] - Error in depth visualization: Invalid shape (8, 3, 224, 224) for image data
[2026-01-27 04:28:30,057][base_trainer_accelerate.py][INFO] - Traceback (most recent call last):
  File "/mnt/localssd/Pi3_training/./trainers/pi3_trainer.py", line 176, in log_depth_visualizations
    fig = self.create_depth_visualization(rgb, depth_gt, depth_p)
  File "/mnt/localssd/Pi3_training/./trainers/pi3_trainer.py", line 118, in create_depth_visualization
    axes[0].imshow(rgb)
  File "/mnt/localssd/miniconda3/envs/py39/lib/python3.9/site-packages/matplotlib/__init__.py", line 1476, in inner
    return func(
  File "/mnt/localssd/miniconda3/envs/py39/lib/python3.9/site-packages/matplotlib/axes/_axes.py", line 5895, in imshow
    im.set_data(X)
  File "/mnt/localssd/miniconda3/envs/py39/lib/python3.9/site-packages/matplotlib/image.py", line 729, in set_data
    self._A = self._normalize_image_array(A)
  File "/mnt/localssd/miniconda3/envs/py39/lib/python3.9/site-packages/matplotlib/image.py", line 697, in _normalize_image_array
    raise TypeError(f"Invalid shape {A.shape} for image data")
TypeError: Invalid shape (8, 3, 224, 224) for image data

[2026-01-27 04:28:30,058][utils.dist][INFO] - [rank: 0] Validation Epoch: [31]  [ 0/15]  eta: 0:01:18  loss: 0.0157 (0.0157)  local_pts_loss: 0.0142 (0.0142)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0001)  rot_loss: 0.0100 (0.0100)  time: 5.2512  data: 4.8067  max mem: 25286
[2026-01-27 04:28:35,674][utils.dist][INFO] - [rank: 0] Validation Epoch: [31]  [14/15]  eta: 0:00:00  loss: 0.0157 (0.0157)  local_pts_loss: 0.0142 (0.0142)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0001)  rot_loss: 0.0100 (0.0100)  time: 0.7244  data: 0.3207  max mem: 25286
[2026-01-27 04:28:35,946][utils.dist][INFO] - [rank: 0] Validation Epoch: [31] Total time: 0:00:11 (0.7427 s / it)
[2026-01-27 04:28:35,969][base_trainer_accelerate.py][INFO] - Validation results: loss: 0.0157 (0.0158)  local_pts_loss: 0.0142 (0.0142)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0001)  rot_loss: 0.0100 (0.0099)
[2026-01-27 04:28:35,971][accelerate.accelerator][INFO] - Saving current state to /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/best_model
[2026-01-27 04:28:40,255][accelerate.checkpointing][INFO] - Model weights saved in /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/best_model/pytorch_model.bin
[2026-01-27 04:28:46,091][accelerate.checkpointing][INFO] - Optimizer state saved in /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/best_model/optimizer.bin
[2026-01-27 04:28:46,092][accelerate.checkpointing][INFO] - Scheduler state saved in /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/best_model/scheduler.bin
[2026-01-27 04:28:46,094][accelerate.checkpointing][INFO] - Random states saved in /mnt/localssd/Pi3_training/outputs/pi3_hospital_lowres/ckpts/best_model/random_states_0.pkl
[2026-01-27 04:28:46,096][base_trainer_accelerate.py][INFO] - Saved best model at epoch 31 with val_metric: 0.0158
[2026-01-27 04:28:48,186][base_trainer_accelerate.py][INFO] - Start training epoch 32, 800 iters per inner epoch. Training dtype bf16
[2026-01-27 04:29:02,978][utils.dist][INFO] - [rank: 0] Epoch: [32]  [     0/625000]  eta: 106 days, 23:32:42  lr: 0.000032  min_lr: 0.000003  loss: 0.0142 (0.0142)  local_pts_loss: 0.0128 (0.0128)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0000 (0.0000)  rot_loss: 0.0113 (0.0113)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3247 (0.3247)  time: 14.7891  data: 10.3746  max mem: 23282
[2026-01-27 04:30:03,963][utils.dist][INFO] - [rank: 0] Epoch: [32]  [    40/625000]  eta: 13 days, 8:49:05  lr: 0.000032  min_lr: 0.000003  loss: 0.0113 (0.0124)  local_pts_loss: 0.0097 (0.0107)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0001)  rot_loss: 0.0079 (0.0091)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.2668 (0.3304)  time: 1.5262  data: 0.0004  max mem: 25273
[2026-01-27 04:31:04,812][utils.dist][INFO] - [rank: 0] Epoch: [32]  [    80/625000]  eta: 12 days, 4:46:23  lr: 0.000032  min_lr: 0.000003  loss: 0.0133 (0.0129)  local_pts_loss: 0.0109 (0.0109)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0001)  rot_loss: 0.0097 (0.0098)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3432 (0.3702)  time: 1.5468  data: 0.0004  max mem: 25273
[2026-01-27 04:32:07,414][utils.dist][INFO] - [rank: 0] Epoch: [32]  [   120/625000]  eta: 11 days, 21:46:24  lr: 0.000032  min_lr: 0.000003  loss: 0.0136 (0.0133)  local_pts_loss: 0.0115 (0.0111)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0001)  rot_loss: 0.0094 (0.0100)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3422 (0.3843)  time: 1.5770  data: 0.0004  max mem: 25273
[2026-01-27 04:33:08,962][utils.dist][INFO] - [rank: 0] Epoch: [32]  [   160/625000]  eta: 11 days, 17:06:26  lr: 0.000032  min_lr: 0.000003  loss: 0.0124 (0.0131)  local_pts_loss: 0.0100 (0.0109)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0001)  rot_loss: 0.0089 (0.0099)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3314 (0.3820)  time: 1.5420  data: 0.0004  max mem: 25275
[2026-01-27 04:34:12,171][utils.dist][INFO] - [rank: 0] Epoch: [32]  [   200/625000]  eta: 11 days, 15:43:30  lr: 0.000032  min_lr: 0.000003  loss: 0.0144 (0.0135)  local_pts_loss: 0.0113 (0.0109)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0002)  rot_loss: 0.0128 (0.0104)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3900 (0.3906)  time: 1.5849  data: 0.0004  max mem: 25275
[2026-01-27 04:35:14,788][utils.dist][INFO] - [rank: 0] Epoch: [32]  [   240/625000]  eta: 11 days, 14:22:11  lr: 0.000031  min_lr: 0.000003  loss: 0.0133 (0.0136)  local_pts_loss: 0.0101 (0.0109)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0002 (0.0002)  rot_loss: 0.0130 (0.0108)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4164 (0.4016)  time: 1.5419  data: 0.0004  max mem: 25275
[2026-01-27 04:36:16,944][utils.dist][INFO] - [rank: 0] Epoch: [32]  [   280/625000]  eta: 11 days, 13:06:39  lr: 0.000031  min_lr: 0.000003  loss: 0.0131 (0.0136)  local_pts_loss: 0.0106 (0.0110)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0002)  rot_loss: 0.0111 (0.0109)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.4003 (0.4027)  time: 1.5622  data: 0.0004  max mem: 25275
[2026-01-27 04:37:18,164][utils.dist][INFO] - [rank: 0] Epoch: [32]  [   320/625000]  eta: 11 days, 11:39:17  lr: 0.000031  min_lr: 0.000003  loss: 0.0133 (0.0136)  local_pts_loss: 0.0104 (0.0110)  normal_loss: 0.0000 (0.0000)  trans_loss: 0.0001 (0.0002)  rot_loss: 0.0125 (0.0111)  weight_decay: 0.0500 (0.0500)  grad_norm: 0.3291 (0.3976)  time: 1.5118  data: 0.0004  max mem: 25276
